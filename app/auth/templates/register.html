{% extends "base.html" %}

{% block title %}Register{% endblock %}

{% block main_content %}

<div class="card-container">
  <div class="card">

    <h1>Create Account</h1>
    <p>Join the Online Examination System</p>

    <form method="POST" action="">
      {{ form.hidden_tag() }}

      <!-- Role -->
      <div class="form-group">
        {{ form.role.label }}
        <div class="radio-inline">
          {% for subfield in form.role %}
            <label class="radio-item">
              {{ subfield }} {{ subfield.label.text }}
            </label>
          {% endfor %}
        </div>
        {% if form.role.errors %}
          <div class="text-danger">
            {% for error in form.role.errors %}
              <small>{{ error }}</small><br>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <!-- Email -->
      <div class="form-group">
        {{ form.email.label }}
        {{ form.email(class="form-control", placeholder="Email address") }}
        {% if form.email.errors %}
          <div class="text-danger">
            {% for error in form.email.errors %}
              <small>{{ error }}</small><br>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <!-- Password -->
      <div class="form-group">
        {{ form.password.label }}
        {{ form.password(class="form-control", placeholder="Password") }}
        {% if form.password.errors %}
          <div class="text-danger">
            {% for error in form.password.errors %}
              <small>{{ error }}</small><br>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <!-- Name -->
      <div class="form-group">
        {{ form.name.label }}
        {{ form.name(class="form-control", placeholder="Full name") }}
        {% if form.name.errors %}
          <div class="text-danger">
            {% for error in form.name.errors %}
              <small>{{ error }}</small><br>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <!-- Student-only -->
      <div id="student-fields">
        <div class="form-group">
          {{ form.roll_number.label }}
          {{ form.roll_number(class="form-control", placeholder="Student ID") }}
        </div>

        <div class="form-group">
          {{ form.contact_number.label }}
          {{ form.contact_number(class="form-control", placeholder="Contact number") }}
        </div>
      </div>

      <button type="submit" class="btn btn-primary btn-block">
        Register
      </button>
    </form>

    <p style="margin-top:20px;">
      Already have an account?
      <a href="{{ url_for('authBp.login') }}">Login</a>
    </p>

  </div>
</div>

<script>
function updateStudentFields() {
  const studentFields = document.getElementById('student-fields');
  const roles = document.getElementsByName('role');
  let selected = 'Student';
  for (const r of roles) {
    if (r.checked) selected = r.value;
  }
  studentFields.style.display = selected === 'Student' ? 'block' : 'none';
}

document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('input[name="role"]').forEach(r =>
    r.addEventListener('change', updateStudentFields)
  );
  updateStudentFields();
});
</script>

{% endblock %}
